<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Matside — Upcoming Matches By Mat</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js"></script>

<style>
/* ------------------------ */
/* GLOBAL DARK MATSIDE THEME */
/* ------------------------ */

body {
  margin: 0;
  padding: 20px;
  background: radial-gradient(ellipse at center, #0d0d0d 0%, #000000 100%);
  color: #f5f5f5 !important;
  font-family: "Inter", Arial, sans-serif;
}

h1 {
  text-align: center;
  font-size: 32px;
  color: #ffffff;
  margin-bottom: 28px;
  text-shadow: 0 0 12px rgba(255,255,255,0.8);
}

/* ------------------------ */
/* GRID LAYOUT */
/* ------------------------ */

.mat-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 28px;
}

/* ------------------------ */
/* MAT CARDS */
/* ------------------------ */

.mat-card {
  padding: 20px;
  border-radius: 14px;
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(8px);
  border: 1px solid rgba(255,255,255,0.06);
  box-shadow: 0 0 22px rgba(255,255,255,0.05);
}

.mat-card h2 {
  text-align: center;
  font-size: 22px;
  letter-spacing: 1px;
  margin-bottom: 18px;
  text-shadow: 0 0 10px rgba(255,255,255,0.5);
}

/* ------------------------ */
/* TIER TITLES */
/* ------------------------ */

.tier-title {
  margin-top: 16px;
  margin-bottom: 8px;
  font-size: 15px;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  opacity: 0.85;
  padding-bottom: 4px;
}

.now-wrestling-title {
  color: #ff6b6b;
  text-shadow: 0 0 10px rgba(255,80,80,0.8);
}

.on-deck-title {
  color: #6db4ff;
  text-shadow: 0 0 10px rgba(80,150,255,0.7);
}

.in-hole-title {
  color: #ffd66b;
  text-shadow: 0 0 10px rgba(255,200,80,0.7);
}

.upcoming-title {
  color: #ffffff;
  opacity: 0.7;
  text-shadow: 0 0 6px rgba(255,255,255,0.4);
}

/* ------------------------ */
/* MATCH CARDS */
/* ------------------------ */

.match-item {
  padding: 12px 14px;
  margin-bottom: 10px;
  border-radius: 10px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.08);
  backdrop-filter: blur(4px);
  box-shadow: 0 0 10px rgba(255,255,255,0.05);
  font-size: 14px;
}

.match-item strong {
  font-size: 15px;
  text-shadow: 0 0 6px rgba(255,255,255,0.6);
}

.now-wrestling {
  border-left: 4px solid #ff4b4b;
  box-shadow: 0 0 14px rgba(255,60,60,0.4);
}

.on-deck {
  border-left: 4px solid #3f8cff;
  box-shadow: 0 0 14px rgba(60,130,255,0.4);
}

.in-hole {
  border-left: 4px solid #ffb84b;
  box-shadow: 0 0 14px rgba(255,180,60,0.4);
}

/* ------------------------ */
/* EMPTY STATE */
/* ------------------------ */

.empty-text {
  margin: 8px 0 18px;
  font-size: 13px;
  opacity: 0.55;
  text-shadow: 0 0 4px rgba(255,255,255,0.3);
}

</style>
</head>

<body>

<h1>MATSIDE — UPCOMING MATCHES BY MAT</h1>

<div class="mat-grid">
  <div class="mat-card"><h2>Mat 1</h2><div id="mat-1"></div></div>
  <div class="mat-card"><h2>Mat 2</h2><div id="mat-2"></div></div>
  <div class="mat-card"><h2>Mat 3</h2><div id="mat-3"></div></div>
  <div class="mat-card"><h2>Mat 4</h2><div id="mat-4"></div></div>
</div>

<script>
////////////////////////////////////////////////////
// FIREBASE INIT
////////////////////////////////////////////////////
const firebaseConfig = {
  apiKey: "AIzaSyD_uk47fURmQiHZnN8avfcGoNObMntdu_s",
  authDomain: "matsidewrestlingco-fb85f.firebaseapp.com",
  projectId: "matsidewrestlingco-fb85f",
  storageBucket: "matsidewrestlingco-fb85f.firebasestorage.app",
  messagingSenderId: "898197416726",
  appId: "1:898197416726:web:921ccbd0f63f7fd6537e37"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

////////////////////////////////////////////////////
// REAL-TIME LISTENER
////////////////////////////////////////////////////
db.collection("matchLibrary").onSnapshot(snapshot => {
  const matches = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));

  const mats = { 1: [], 2: [], 3: [], 4: [] };

  matches.forEach(m => {
    const mat = Number(m.assignedMat);
    if (mat >= 1 && mat <= 4) mats[mat].push(m);
  });

  for (let m = 1; m <= 4; m++) {
    mats[m].sort((a, b) => (a.queueIndex ?? 9999) - (b.queueIndex ?? 9999));
  }

  for (let m = 1; m <= 4; m++) renderMat(m, mats[m]);
});

////////////////////////////////////////////////////
// RENDER A MAT COLUMN
////////////////////////////////////////////////////
function renderMat(matNum, list) {
  const root = document.getElementById(`mat-${matNum}`);
  root.innerHTML = "";

  if (!list.length) {
    root.innerHTML = `<div class="empty-text">No upcoming matches</div>`;
    return;
  }

  const now = list[0] || null;
  const onDeck = list[1] || null;
  const inHole = list[2] || null;
  const upcoming = list.slice(3);

  root.innerHTML += `<div class="tier-title now-wrestling-title">Now Wrestling</div>`;
  now ? root.appendChild(item(now, "now-wrestling")) :
    root.innerHTML += `<div class="empty-text">— None —</div>`;

  root.innerHTML += `<div class="tier-title on-deck-title">On Deck</div>`;
  onDeck ? root.appendChild(item(onDeck, "on-deck")) :
    root.innerHTML += `<div class="empty-text">— None —</div>`;

  root.innerHTML += `<div class="tier-title in-hole-title">In The Hole</div>`;
  inHole ? root.appendChild(item(inHole, "in-hole")) :
    root.innerHTML += `<div class="empty-text">— None —</div>`;

  root.innerHTML += `<div class="tier-title upcoming-title">Upcoming</div>`;
  if (!upcoming.length) {
    root.innerHTML += `<div class="empty-text">— None —</div>`;
  } else {
    upcoming.forEach(m => root.appendChild(item(m)));
  }
}

////////////////////////////////////////////////////
// MATCH CARD COMPONENT
////////////////////////////////////////////////////
function item(match, cls = "") {
  const div = document.createElement("div");
  div.className = `match-item ${cls}`;

  div.innerHTML = `
    <div><strong>Bout ${match.bout}</strong> — ${match.weight || "?"} lbs</div>
    <div>${match.red.name} (${match.red.team}) vs ${match.green.name} (${match.green.team})</div>
    <div class="match-meta">Round: ${match.round}</div>
  `;

  return div;
}
</script>
</body>
</html>
