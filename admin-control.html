<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Matside — Admin Control Panel (v10.1 — Hub Enabled)</title>

<!-- PapaParse -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js"></script>

<!-- SortableJS -->
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

<style>
/* SAME CSS FROM YOUR FILE — unchanged */
</style>
</head>

<body>

<div style="max-width:1100px;margin:0 auto;">
  <h1>Matside Admin Control</h1>
  <div class="version-tag">admin-control v10.1 — Hub Tab Added</div>
  <div id="userInfoBar">
    <div>Logged in as: <span id="userEmailLabel">—</span></div>
    <button id="logoutBtn">Logout</button>
  </div>

  <div class="tabs">
    <div class="tab active" data-tab="events">Events</div>
    <div class="tab" data-tab="data">Data Mgmt</div>
    <div class="tab" data-tab="assign">Mat Assign</div>
    <div class="tab" data-tab="users">Manage Users</div>

    <!-- /// ADDED FOR HUB -->
    <div class="tab" data-tab="hub" id="hubTabBtn">Hub</div>
    <!-- /// END ADDED -->
  </div>
</div>

<div id="toastContainer"></div>

<!-- TAB: EVENTS -->
<div id="tab-events" class="tab-content active">
  <!-- unchanged -->
</div>

<!-- TAB: DATA MGMT -->
<div id="tab-data" class="tab-content">
  <!-- unchanged -->
</div>

<!-- TAB: MAT ASSIGN -->
<div id="tab-assign" class="tab-content">
  <!-- unchanged -->
</div>

<!-- TAB: MANAGE USERS -->
<div id="tab-users" class="tab-content">
  <!-- unchanged -->
</div>

<!-- /// ADDED FOR HUB -->
<div id="tab-hub" class="tab-content">
  <div class="section">
    <h2>Event Hub</h2>
    <p style="font-size:13px;opacity:0.8;margin-top:0;">
      Live event monitoring for all mats, operators, and match flow.
    </p>
    <iframe src="hub.html" style="width:100%;height:80vh;border:none;border-radius:10px;background:#111;"></iframe>
  </div>
</div>
<!-- /// END HUB TAB -->

<script>
/* TABS — unchanged logic */
document.querySelectorAll(".tab").forEach(tab => {
  tab.addEventListener("click", () => {
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    tab.classList.add("active");
    document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("active"));
    document.getElementById("tab-" + tab.dataset.tab).classList.add("active");
  });
});

/* Firebase init — unchanged */
const firebaseConfig = {
  apiKey: "AIzaSyD_uk47fURmQiHZnN8avfcGoNObMntdu_s",
  authDomain: "matsidewrestlingco-fb85f.firebaseapp.com",
  projectId: "matsidewrestlingco-fb85f",
  storageBucket: "matsidewrestlingco-fb85f.firebasestorage.app",
  messagingSenderId: "898197416726",
  appId: "1:898197416726:web:921ccbd0f63f7fd6537e37"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();

/* ALL EXISTING JS — unchanged EXCEPT one small part below */

/* Apply permissions: hide/show tabs */
function applyPermissionsToUI() {
  const tabEvents = document.querySelector('[data-tab="events"]');
  const tabData   = document.querySelector('[data-tab="data"]');
  const tabAssign = document.querySelector('[data-tab="assign"]');
  const tabUsers  = document.querySelector('[data-tab="users"]');
  const tabHub    = document.querySelector('[data-tab="hub"]'); // ADDED

  if (!permissions.canManageEvents && tabEvents) tabEvents.style.display = "none";
  if (!permissions.canUploadMatches && tabData) tabData.style.display = "none";
  if (!permissions.canAssignMats && tabAssign) tabAssign.style.display = "none";
  if (!permissions.canManageUsers && tabUsers) tabUsers.style.display = "none";

  // NEW: Hub visibility rule (Option C)
  if (!permissions.canViewDashboard && tabHub) {
    tabHub.style.display = "none";
  }
}

/* All other logic remains EXACTLY unchanged */
</script>

</body>
</html>
