<!-- overview.html -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Matside — Tournament Overview</title>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<style>
  :root{
    --bg:#070809; --panel:#15161a; --muted:#9aa0a6;
    --red:#c62828; --green:#2e7d32;
  }
  body{
    margin:0;
    background:var(--bg);
    color:#fff;
    font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  }
  .header-bar{
    background:#070809;
    border-bottom:1px solid #111215;
  }
  .header-inner{
    max-width:1100px;
    margin:0 auto;
    padding:4px 14px;
    display:flex;
    align-items:center;
    gap:10px;
  }
  .brand-logo{height:42px;border-radius:8px;}
  .brand-title{font-size:18px;font-weight:700;}
  .header-accent{
    height:2px;
    background:linear-gradient(90deg,rgba(30,136,229,0.12),rgba(30,136,229,0.5),rgba(30,136,229,0.12));
  }

  .wrap{padding:14px;max-width:1100px;margin:0 auto;}
  h1{font-size:22px;margin:0 0 14px 0;text-align:center;}

  .grid{
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:16px;
  }
  @media(max-width:800px){ .grid{grid-template-columns:1fr;} }

  .mat-card{
    background:#111;
    padding:10px;
    border-radius:10px;
    box-shadow:0 4px 14px rgba(0,0,0,0.6);
    text-align:center;
    border:2px solid transparent;
    position:relative;
  }
  .mat-title{font-size:18px;font-weight:800;margin-bottom:6px;}
  .period{font-size:14px;opacity:0.8;}
  .timer{font-size:40px;font-weight:800;margin:6px 0 10px;}
  @keyframes flash{
    0% {color:#fff;}
    50%{color:#ff3333;}
    100%{color:#fff;}
  }
  .flash{animation:flash 1s infinite;}

  .names{
    display:flex;justify-content:space-between;font-size:14px;
    opacity:0.9;font-weight:600;margin:6px 0;
  }
  .scores{
    display:flex;justify-content:space-between;gap:8px;
  }
  .red-box,.green-box{
    flex:1;padding:14px 0;font-size:42px;font-weight:800;border-radius:10px;
  }
  .red-box{background:var(--red);}
  .green-box{background:var(--green);}
  .winner-banner{
    position:absolute;left:0;right:0;bottom:0;
    padding:6px 0;font-size:18px;font-weight:900;
    text-transform:uppercase;border-radius:0 0 8px 8px;display:none;
  }
  .winner-red .winner-banner{background:var(--red);display:block;}
  .winner-green .winner-banner{background:var(--green);display:block;}
  .winner-red{border-color:var(--red);}
  .winner-green{border-color:var(--green);}
  .winner-red .green-box,
  .winner-green .red-box{opacity:0.3;}
  .small-info{margin-top:4px;font-size:12px;opacity:0.6;}

  #version-tag{
    position:fixed;
    bottom:6px;
    right:10px;
    font-size:11px;
    color:#666;
    opacity:0.75;
    pointer-events:none;
    user-select:none;
    font-weight:600;
    z-index:99999;
  }
</style>
</head>
<body>
<div class="header-bar">
  <div class="header-inner">
    <img src="https://www.matside.org/assets/images/image01.png" alt="Matside" class="brand-logo"/>
    <div class="brand-title">Matside</div>
  </div>
  <div class="header-accent"></div>
</div>

<div class="wrap">
  <h1>Live Tournament Overview</h1>
  <div class="grid">
    <!-- Mat 1–4 cards (same as before, condensed) -->
    <div class="mat-card" id="mat1">
      <div class="mat-title">MAT 1</div>
      <div class="period">Period: <span class="period-num">1</span></div>
      <div class="timer">00:00</div>
      <div class="names">
        <span class="red-name">RED</span>
        <span class="green-name">GREEN</span>
      </div>
      <div class="scores">
        <div class="red-box"><span class="red-score">0</span></div>
        <div class="green-box"><span class="green-score">0</span></div>
      </div>
      <div class="winner-banner"></div>
      <div class="small-info">• Live •</div>
    </div>

    <div class="mat-card" id="mat2">
      <div class="mat-title">MAT 2</div>
      <div class="period">Period: <span class="period-num">1</span></div>
      <div class="timer">00:00</div>
      <div class="names">
        <span class="red-name">RED</span>
        <span class="green-name">GREEN</span>
      </div>
      <div class="scores">
        <div class="red-box"><span class="red-score">0</span></div>
        <div class="green-box"><span class="green-score">0</span></div>
      </div>
      <div class="winner-banner"></div>
      <div class="small-info">• Live •</div>
    </div>

    <div class="mat-card" id="mat3">
      <div class="mat-title">MAT 3</div>
      <div class="period">Period: <span class="period-num">1</span></div>
      <div class="timer">00:00</div>
      <div class="names">
        <span class="red-name">RED</span>
        <span class="green-name">GREEN</span>
      </div>
      <div class="scores">
        <div class="red-box"><span class="red-score">0</span></div>
        <div class="green-box"><span class="green-score">0</span></div>
      </div>
      <div class="winner-banner"></div>
      <div class="small-info">• Live •</div>
    </div>

    <div class="mat-card" id="mat4">
      <div class="mat-title">MAT 4</div>
      <div class="period">Period: <span class="period-num">1</span></div>
      <div class="timer">00:00</div>
      <div class="names">
        <span class="red-name">RED</span>
        <span class="green-name">GREEN</span>
      </div>
      <div class="scores">
        <div class="red-box"><span class="red-score">0</span></div>
        <div class="green-box"><span class="green-score">0</span></div>
      </div>
      <div class="winner-banner"></div>
      <div class="small-info">• Live •</div>
    </div>

  </div>
</div>

<script>
const SERVER = "https://scoreboard-server-er33.onrender.com";
const socket = io(SERVER, { transports:["websocket"] });

function fmt(sec){
  sec = Math.max(0, Number(sec)||0);
  const m = Math.floor(sec/60), s = sec%60;
  return (m<10?'0':'')+m+':' + (s<10?'0':'')+s;
}

socket.on("stateUpdate", state => {
  if (!state || !state.mats) return;

  for (let mat = 1; mat <= 4; mat++) {
    const m = state.mats[mat];
    if (!m) continue;

    const card = document.getElementById("mat" + mat);
    const timerEl = card.querySelector(".timer");
    const winnerEl = card.querySelector(".winner-banner");

    card.classList.remove("winner-red","winner-green");
    winnerEl.style.display = "none";

    card.querySelector(".period-num").textContent = m.period;
    timerEl.textContent = fmt(m.timeRemaining);
    card.querySelector(".red-score").textContent = m.player1;
    card.querySelector(".green-score").textContent = m.player2;
    card.querySelector(".red-name").textContent = m.redName || "RED";
    card.querySelector(".green-name").textContent = m.greenName || "GREEN";

    if (m.timeRemaining === 0) {
      timerEl.classList.add("flash");
      if (m.player1 > m.player2) {
        card.classList.add("winner-red");
        winnerEl.textContent = "WINNER — RED";
      } else if (m.player2 > m.player1) {
        card.classList.add("winner-green");
        winnerEl.textContent = "WINNER — GREEN";
      } else {
        winnerEl.textContent = "MATCH OVER";
      }
      winnerEl.style.display = "block";
    } else {
      timerEl.classList.remove("flash");
    }
  }
});
</script>
<script src="version-loader.js"></script>
</body>
</html>
